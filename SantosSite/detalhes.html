<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Detalhes do Santo</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,600;0,800;1,600&family=Plus+Jakarta+Sans:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <style>
        /* --- CONFIGURA√á√ïES GERAIS --- */
        body { 
            font-family: 'Plus Jakarta Sans', sans-serif; 
            background-color: #f8f9fc; 
            color: #4a4a4a;
            overflow-x: hidden;
        }
        
        h1, h2, h3, h4, h5 { font-family: 'Playfair Display', serif; }

        /* --- HERO SECTION (BANNER + FOTO) --- */
        .hero-container {
            position: relative;
            /* Aumentei o espa√ßo aqui para a foto n√£o bater no texto */
            margin-bottom: 120px; 
        }


        /* CORRE√á√ÉO DA POSI√á√ÉO DA FOTO */
        .perfil-wrapper {
            position: absolute;
            /* Posiciona o centro da wrapper exatamente na borda inferior do banner */
            bottom: 0;
            left: 50%;
            /* Move 50% para esquerda (centralizar) e 50% para baixo (ficar metade fora) */
            transform: translate(-50%, 50%);
            z-index: 10;
            width: 100%;
            text-align: center;
            pointer-events: none; /* Permite clicar no que estiver atr√°s, se precisar */
        }

        .foto-perfil {
            width: 240px;
            height: 240px;
            object-fit: cover;
            border-radius: 50%;
            border: 12px solid #fff;
            box-shadow: 0 25px 50px rgba(0,0,0,0.15);
            background-color: white;
            transition: transform 0.5s ease;
            pointer-events: auto; /* Reabilita cliques na foto */
        }
        .foto-perfil:hover { transform: scale(1.03); }

        /* DADOS DO SANTO (TEXTO) */
        .info-header {
            text-align: center;
            /* Aumentei a margem superior para dar espa√ßo para a foto */
            margin-top: 130px; 
            opacity: 0;
            animation: subirFade 0.8s ease forwards 0.3s;
            position: relative;
            z-index: 5;
        }

        .badge-categoria {
            display: inline-block;
            padding: 10px 30px;
            border-radius: 50px;
            background: #333; /* JS muda */
            color: #fff;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 2px;
            font-size: 0.8rem;
            margin-bottom: 20px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
            /* Garante que a badge tenha altura mesmo sem texto (para debug) */
            min-height: 1em; 
        }

        .nome-santo { font-size: 4.5rem; font-weight: 800; color: #222; margin: 0; line-height: 1.1; letter-spacing: -1px; }
        .titulo-santo { font-size: 1.4rem; color: #777; font-style: italic; margin-top: 10px; font-family: 'Playfair Display', serif; }

        /* --- FICHA T√âCNICA E CONTE√öDO --- */
        .ficha-tecnica { display: flex; justify-content: center; gap: 40px; margin: 40px 0; flex-wrap: wrap; opacity: 0; animation: subirFade 0.8s ease forwards 0.4s; }
        .ficha-item { text-align: center; background: white; padding: 15px 30px; border-radius: 15px; box-shadow: 0 5px 15px rgba(0,0,0,0.05); border: 1px solid rgba(0,0,0,0.03); min-width: 150px; }
        .ficha-label { font-size: 0.8rem; text-transform: uppercase; letter-spacing: 1px; color: #999; font-weight: 700; display: block; margin-bottom: 5px; }
        .ficha-valor { font-size: 1.1rem; font-weight: 700; color: #333; }

        .section-card { background: white; padding: 60px; border-radius: 30px; border: 1px solid rgba(0,0,0,0.02); box-shadow: 0 20px 40px rgba(0,0,0,0.04); margin-bottom: 40px; opacity: 0; animation: subirFade 0.8s ease forwards 0.5s; }
        .primeira-letra { float: left; font-family: 'Playfair Display', serif; font-size: 5rem; line-height: 0.8; font-weight: 700; margin-right: 20px; margin-bottom: -10px; margin-top: 10px; }
        .texto-historia { font-size: 1.2rem; line-height: 1.9; color: #555; text-align: justify; }

        .card-detalhe { background: #fff; border-radius: 20px; padding: 30px; height: 100%; transition: transform 0.3s, box-shadow 0.3s; border: 1px solid rgba(0,0,0,0.03); position: relative; overflow: hidden; }
        .card-detalhe:hover { transform: translateY(-5px); box-shadow: 0 15px 30px rgba(0,0,0,0.08); }
        .indicador-cor { position: absolute; left: 0; top: 0; bottom: 0; width: 6px; background: #ccc; }
        .titulo-detalhe { font-size: 1.2rem; font-weight: 700; margin-bottom: 10px; color: #222; }
        .texto-detalhe { font-size: 0.95rem; color: #666; margin-bottom: 0; }

        .grade-mosaico { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 25px; opacity: 0; animation: subirFade 0.8s ease forwards 0.8s; }
        .item-galeria { height: 350px; border-radius: 24px; overflow: hidden; position: relative; box-shadow: 0 10px 30px rgba(0,0,0,0.1); cursor: pointer; }
        .item-galeria img { width: 100%; height: 100%; object-fit: cover; transition: transform 0.6s ease; }
        .item-galeria:hover img { transform: scale(1.1); }

        @keyframes subirFade { from { opacity: 0; transform: translateY(40px); } to { opacity: 1; transform: translateY(0); } }

        .nav-flutuante { position: absolute; top: 30px; left: 30px; z-index: 100; }
        .btn-voltar { background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(10px); border: none; padding: 12px 30px; border-radius: 100px; font-weight: 700; color: #333; box-shadow: 0 10px 20px rgba(0,0,0,0.1); transition: all 0.3s; text-decoration: none; }
        .btn-voltar:hover { transform: scale(1.05); color: #000; box-shadow: 0 15px 30px rgba(0,0,0,0.15); }
        #loading { height: 100vh; display: flex; align-items: center; justify-content: center; }
/* ============================= */
/* VARI√ÅVEL GLOBAL DA COR DO SANTO */
/* ============================= */
:root {
  --cor-santo: #cccccc;
  --cor-santo-escura: #888888;
}

/* HERO */
.banner-santo {
  height: 420px;
  width: 100%;
  background: linear-gradient(
    135deg,
    var(--cor-santo) 0%,
    #ffffff 100%
  ) !important;

  border-bottom-left-radius: 60% 20%;
  border-bottom-right-radius: 60% 20%;
}


/* BADGE CATEGORIA */
.badge-categoria {
  background: var(--cor-santo-escura);
  color: #fff;
  text-shadow: 0 1px 2px rgba(0,0,0,.25);
}

/* FOTO PERFIL */
.foto-perfil {
  border: 12px solid #fff;
  box-shadow: 0 30px 60px rgba(0,0,0,.18);
}

/* FICHA T√âCNICA */
.ficha-item {
  border-top: 5px solid var(--cor-santo);
}

/* CARDS DE MILAGRES / LOCAIS */
.indicador-cor {
  background: linear-gradient(
    to bottom,
    var(--cor-santo-escura),
    transparent
  );
}

/* T√çTULOS */
.nome-santo {
  font-size: 4.2rem;
}

.titulo-santo {
  font-style: italic;
  opacity: .8;
}

/* GALERIA */
.item-galeria {
  border-radius: 28px;
}

/* ANIMA√á√ÉO SUAVE */
.section-card,
.grade-mosaico,
.ficha-tecnica {
  animation: subirFade .8s ease forwards;
}

    </style>
</head>
<body>

    <div class="nav-flutuante">
        <a href="index.html" class="btn-voltar">‚Üê Voltar</a>
    </div>

    <div id="loading">
        <div class="spinner-grow text-secondary" role="status"></div>
    </div>
    
    <div id="conteudo-santo" style="display: none;">
        
        <div class="hero-container">
            <div id="banner" class="banner-santo"></div>
            
            <div class="perfil-wrapper">
                <img id="foto" src="" class="foto-perfil" alt="Foto do Santo">
            </div>
        </div>

        <div class="container pb-5">
            
            <div class="info-header">
                <span id="categoria" class="badge-categoria">Carregando...</span>
                <h1 id="nome" class="nome-santo">Nome do Santo</h1>
                <p id="titulo" class="titulo-santo">T√≠tulo do Santo</p>
            </div>

            <div class="ficha-tecnica">
                <div class="ficha-item" id="box-nascimento">
                    <span class="ficha-label">üë∂ Nascimento</span>
                    <span class="ficha-valor" id="nascimento-txt">?</span>
                </div>
                <div class="ficha-item" id="box-falecimento">
                    <span class="ficha-label">‚úùÔ∏è Falecimento</span>
                    <span class="ficha-valor" id="falecimento-txt">?</span>
                </div>
                <div class="ficha-item" id="box-festa">
                    <span class="ficha-label">üéâ Dia da Festa</span>
                    <span class="ficha-valor" id="festa-txt">?</span>
                </div>
            </div>

            <div class="row justify-content-center">
                <div class="col-lg-10">
                    
                    <div class="section-card">
                        <div id="historia-texto" class="texto-historia"></div>
                    </div>

                    <div class="row g-4 mb-5">
                        <div class="col-md-6" id="coluna-milagres" style="display:none;">
                            <h3 class="fw-bold mb-4 ps-2">‚ú® Milagres</h3>
                            <div id="lista-milagres" class="d-flex flex-column gap-3"></div>
                        </div>

                        <div class="col-md-6" id="coluna-locais" style="display:none;">
                            <h3 class="fw-bold mb-4 ps-2">üìç Lugares</h3>
                            <div id="lista-locais" class="d-flex flex-column gap-3"></div>
                        </div>
                    </div>

                    <div id="secao-galeria" style="display:none;">
                        <h3 class="text-center mb-4 display-6 fw-bold">Galeria de Imagens</h3>
                        <div id="grade-galeria" class="grade-mosaico"></div>
                    </div>

                </div>
            </div>
        </div>
    </div>

    <script>
    const params = new URLSearchParams(window.location.search);
    const id = params.get('id');
    // API p√∫blica + id do santo
    const API_URL = `https://santos-api-uz5r.onrender.com/api/santos/${id}`;

        // Fun√ß√£o para gerar cor mais escura
        function escurecerCor(cor, porcentagem) {
            let r = parseInt(cor.substring(1, 3), 16);
            let g = parseInt(cor.substring(3, 5), 16);
            let b = parseInt(cor.substring(5, 7), 16);
            r = Math.max(0, parseInt(r * (100 - porcentagem) / 100));
            g = Math.max(0, parseInt(g * (100 - porcentagem) / 100));
            b = Math.max(0, parseInt(b * (100 - porcentagem) / 100));
            return "#" + ((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1);
        }

        async function carregarDetalhes() {
            if(!id) { window.location.href = "index.html"; return; }

            try {
                const response = await fetch(API_URL);
                if(!response.ok) throw new Error("Erro ao buscar santo");
                const santo = await response.json();

                console.log("Dados do Santo:", santo); // Para debug

                // --- CORES E CATEGORIA (CORRE√á√ÉO AQUI) ---
                const corPastel = santo.categoria?.corHex || '#cccccc';
                const corEscura = escurecerCor(corPastel, 45);
                
                /* DEFINE AS VARI√ÅVEIS CSS */
                document.documentElement.style.setProperty('--cor-santo', corPastel);
                document.documentElement.style.setProperty('--cor-santo-escura', corEscura);

                /* HERO COM GRADIENTE */
                document.getElementById('banner').style.background = `linear-gradient(135deg, ${corPastel} 0%, #ffffff 100%)`;

                /* BADGE */
                const badge = document.getElementById('categoria');
                badge.style.backgroundColor = corEscura;    
                badge.innerText = santo.categoria?.nome || 'Geral';

                // L√≥gica mais segura para exibir o nome da categoria
                let nomeCategoria = santo.categoria?.nome;
                if (!nomeCategoria || nomeCategoria.trim() === '') {
                    nomeCategoria = 'Geral';
                }
                badge.innerText = nomeCategoria;


                // --- DADOS B√ÅSICOS ---
                document.getElementById('foto').src = santo.fotoUrl || 'https://via.placeholder.com/300';
                document.getElementById('nome').innerText = santo.nome;
                document.getElementById('titulo').innerText = santo.titulo;

                // --- FICHA T√âCNICA ---
                if(santo.nascimento) document.getElementById('nascimento-txt').innerText = santo.nascimento;
                else document.getElementById('box-nascimento').style.display = 'none';

                if(santo.falecimento) document.getElementById('falecimento-txt').innerText = santo.falecimento;
                else document.getElementById('box-falecimento').style.display = 'none';

                if(santo.festa) document.getElementById('festa-txt').innerText = santo.festa;
                else document.getElementById('box-festa').style.display = 'none';

                // --- HIST√ìRIA ---
                const historiaDiv = document.getElementById('historia-texto');
                if (santo.historia) {
                    const primeiraLetra = santo.historia.charAt(0);
                    const restoTexto = santo.historia.slice(1);
                    historiaDiv.innerHTML = `
                        <span class="primeira-letra" style="color:${corEscura};">${primeiraLetra}</span>
                        ${restoTexto}
                    `;
                } else {
                    historiaDiv.innerHTML = "<p>Hist√≥ria n√£o dispon√≠vel.</p>";
                }

                // --- LISTAS (Milagres, Locais, Galeria) ---
                if(santo.milagres && santo.milagres.length > 0) {
                    const lista = document.getElementById('lista-milagres');
                    santo.milagres.forEach(m => {
                        lista.innerHTML += `
                            <div class="card-detalhe">
                                <div class="indicador-cor" style="background-color: ${corEscura}"></div>
                                <div class="titulo-detalhe">${m.titulo}</div>
                                <p class="texto-detalhe">${m.descricao}</p>
                            </div>`;
                    });
                    document.getElementById('coluna-milagres').style.display = 'block';
                }

                if(santo.locais && santo.locais.length > 0) {
                    const lista = document.getElementById('lista-locais');
                    santo.locais.forEach(l => {
                        lista.innerHTML += `
                            <div class="card-detalhe">
                                <div class="indicador-cor" style="background-color: ${corEscura}"></div>
                                <div class="titulo-detalhe">üìç ${l.nomeLugar}</div>
                                <p class="texto-detalhe">${l.descricao}</p>
                            </div>`;
                    });
                    document.getElementById('coluna-locais').style.display = 'block';
                }

                if(santo.imagens && santo.imagens.length > 0) {
                    const grade = document.getElementById('grade-galeria');
                    santo.imagens.forEach(img => {
                        grade.innerHTML += `
                            <div class="item-galeria">
                                <img src="${img.url}" alt="Foto Galeria">
                            </div>
                        `;
                    });
                    document.getElementById('secao-galeria').style.display = 'block';
                }

                // Mostrar tudo no final
                document.getElementById('loading').style.display = 'none';
                document.getElementById('conteudo-santo').style.display = 'block';

            } catch (error) {
                console.error(error);
                document.getElementById('loading').innerHTML = `<p class="text-danger text-center mt-5">Erro ao carregar detalhes.<br>Verifique se o Backend est√° rodando.</p>`;
            }
        }

        carregarDetalhes();
    </script>
</body>
</html>